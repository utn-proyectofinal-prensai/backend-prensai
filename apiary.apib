FORMAT: 1A

# PrensAI API

## Group Aplicación

## Status [/api/v1/status]

### status [GET]

+ Response 200 (application/json)

    + Body

            {
                "online": true
            }

## Users [/api/v1/user]

### show [GET]

+ Response 200 (application/json)

    + Body

            {
                "user": {
                    "id": 15,
                    "email": "juan.perez@example.com",
                    "username": "juan.perez",
                    "name": "Juan Perez",
                    "first_name": "Juan",
                    "last_name": "Perez",
                    "uid": "vaughn@kovacek.example",
                    "provider": "email",
                    "created_at": "2024-04-26T20:34:58.626Z",
                    "updated_at": "2024-04-26T20:34:58.689Z"
                }
            }

+ Response 404 (application/json)

    + Body

            {
                "errors": [
                    {
                        "message": "Couldn't find the record"
                    }
                ]
            }

### create [POST]

+ Request (application/json)

    + Body

            {
                "user": {
                    "email": "test@example.com",
                    "password": "12345678",
                    "password_confirmation": "12345678",
                    "username": "test",
                    "first_name": "Johnny",
                    "last_name": "Perez"
                }
            }

+ Response 200 (application/json)

    + Body

            {
                "user": {
                    "id": 5,
                    "email": "test@example.com",
                    "name": "Johnny Perez",
                    "username": "test",
                    "first_name": "Johnny",
                    "last_name": "Perez",
                    "uid": "test@example.com",
                    "provider": "email",
                    "created_at": "2024-04-26T20:34:57.901Z",
                    "updated_at": "2024-04-26T20:34:57.979Z"
                }
            }

+ Response 422 (application/json)

    + Body

            {
                "status": "error",
                "data": {
                    "id": null,
                    "email": "test@example.com",
                    "allow_password_change": false,
                    "first_name": "Johnny",
                    "last_name": "Perez",
                    "username": "test",
                    "created_at": null,
                    "updated_at": null,
                    "provider": "email",
                    "uid": "test@example.com",
                    "impersonated_by": null
                },
                "errors": {
                    "password_confirmation": [
                        "doesn't match Password"
                    ],
                    "full_messages": [
                        "Password is too short (minimum is 8 characters)"
                    ],
                    "email": [
                        "is not an email"
                    ],
                    "password": [
                        "is too short (minimum is 8 characters)"
                    ]
                }
            }

### update [PUT]

+ Request (application/json)

    + Body

            {
                "user": {
                    "username": "new username"
                }
            }

+ Response 200 (application/json)

    + Body

            {
                "user": {
                    "id": 10,
                    "email": "juan.perez@example.com",
                    "name": "new username",
                    "username": "new username",
                    "first_name": "",
                    "last_name": "",
                    "uid": "juan.perez@example.com",
                    "provider": "email",
                    "created_at": "2024-04-26T20:34:58.540Z",
                    "updated_at": "2024-04-26T20:34:58.674Z"
                }
            }

+ Response 400 (application/json)

    + Body

            {
                "errors": [
                    {
                        "email": [
                            "is not an email"
                        ]
                    }
                ]
            }

+ Response 422 (application/json)

    + Body

            {
                "errors": [
                    {
                        "message": "A required param is missing"
                    }
                ]
            }

## Contraseña [/api/v1/users/password]

### Recuperar contraseña [POST]

+ Request (application/json)

    + Body

            {
                "email": "juan.perez@example.com"
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "message": "An email has been sent to 'juan.perez@example.com' containing instructions for resetting your password."
            }

+ Response 404 (application/json)

    + Body

            {
                "errors": [
                    {
                        "message": "Unable to find user with email 'notvalid@example.com'."
                    }
                ]
            }

### Actualizar contraseña [PUT]

+ Request (application/json)

    + Body

            {
                "password": "123456789",
                "password_confirmation": "123456789"
            }

+ Response 200 (application/json)

    + Body

            {
                "success": true,
                "data": {
                    "email": "juan.perez@example.com",
                    "provider": "email",
                    "uid": "juan.perez@example.com",
                    "id": 9,
                    "allow_password_change": false,
                    "first_name": "",
                    "last_name": "",
                    "username": "juan.perez",
                    "created_at": "2024-04-26T20:34:58.309Z",
                    "updated_at": "2024-04-26T20:34:58.630Z",
                    "impersonated_by": null
                },
                "message": "Your password has been successfully updated."
            }

+ Response 422 (application/json)

    + Body

            {
                "success": false,
                "errors": {
                    "password_confirmation": [
                        "doesn't match Password"
                    ],
                    "full_messages": [
                        "Password confirmation doesn't match Password"
                    ]
                }
            }

## Login [/api/v1/users/sign_in]

### Iniciar sesión [POST]

+ Request (application/json)

    + Body

            {
                "user": {
                    "email": "juan.perez@example.com",
                    "password": "password"
                }
            }

+ Response 200 (application/json)

    + Body

            {
                "user": {
                    "id": 14,
                    "email": "juan.perez@example.com",
                    "name": "juan perez",
                    "username": "juan.perez",
                    "first_name": "",
                    "last_name": "",
                    "uid": "juan.perez@example.com",
                    "provider": "email",
                    "created_at": "2024-04-26T20:34:58.289Z",
                    "updated_at": "2024-04-26T20:34:58.361Z"
                }
            }

+ Response 401 (application/json)

    + Body

            {
                "errors": [
                    {
                        "message": "Invalid login credentials. Please try again."
                    }
                ]
            }

## Logout [/api/v1/users/sign_out]

### Cerrar sesión [DELETE]

+ Request (application/json)

+ Response 200 (application/json)

    + Body

            {
                "success": true
            }

+ Response 404 (application/json)

    + Body

            {
                "errors": [
                    {
                        "message": "User was not found or was not logged in."
                    }
                ]
            }

## News [/api/v1/news]

### Listar Noticias [GET]

Obtiene una lista paginada de todas las noticias en el sistema, ordenadas por fecha de creación descendente.

**Parámetros de filtrado disponibles:**
- `topic_id`: Filtrar por tema específico
- `start_date`: Filtrar noticias desde una fecha (formato: YYYY-MM-DD)
- `end_date`: Filtrar noticias hasta una fecha (formato: YYYY-MM-DD)
- `media`: Filtrar por medio de comunicación
- `publication_type`: Filtrar por tipo de publicación
- `valuation`: Filtrar por valoración (positive, neutral, negative)

**Ejemplos de uso:**
- `GET /api/v1/news?topic_id=1`
- `GET /api/v1/news?media=TV&valuation=positive`
- `GET /api/v1/news?start_date=2025-01-01&end_date=2025-01-31`

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)

    + Attributes
        + news (array[NewsItem])
        + pagination (Pagination)
        
    + Body
    
        {
            "news": [
                {
                    "id": 1,
                    "title": "Nueva política de transporte",
                    "publication_type": "article",
                    "date": "2025-01-09",
                    "support": "web",
                    "media": "Diario Nacional",
                    "section": "Politics",
                    "author": "María González",
                    "interviewee": null,
                    "link": "https://example.com/news-1",
                    "audience_size": 50000,
                    "quotation": 0.0,
                    "valuation": "neutral",
                    "political_factor": "national",
                    "plain_text": "El gobierno anunció una nueva política...",
                    "crisis": false,
                    "created_at": "2025-01-09T10:30:00Z",
                    "updated_at": "2025-01-09T10:30:00Z",
                    "topic": {
                        "id": 1,
                        "name": "Transport"
                    },
                    "mentions": [
                        {
                            "id": 1,
                            "name": "Ministerio de Transporte"
                        }
                    ],
                    "creator": {
                        "id": 1,
                        "name": "Juan Pérez"
                    },
                    "reviewer": {
                        "id": 2,
                        "name": "Ana García"
                    }
                }
            ],
            "pagination": {
                "page": 1,
                "count": 1,
                "pages": 1,
                "prev": null,
                "next": null
            }
        }      

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

    + Body
    
    {
        "errors": [
            {
                "message": "You need to sign in or sign up before continuing."
            }
        ]
    }

### Procesar Noticias por Lotes [POST /api/v1/news/batch_process]

Procesa múltiples URLs de noticias utilizando IA para extraer información estructurada y persistir las noticias en el sistema. El usuario autenticado se asigna como creador de las noticias procesadas.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "urls": [
                "https://example.com/news-1",
                "https://example.com/news-2"
            ],
            "topics": [
                "Transport",
                "Politics"
            ],
            "mentions": [
                "Mention1",
                "Mention2"
            ]
        }

+ Response 200 (application/json)
    + Attributes
        + received: 2 (number) - Número de URLs recibidas
        + processed_by_ai: 2 (number) - Número de URLs procesadas exitosamente por IA
        + persisted: 2 (number) - Número de noticias persistidas en la base de datos
        + news (array[NewsItem]) - Noticias creadas exitosamente
        + errors (array[ProcessingError]) - Errores de procesamiento

    + Body
    
        {
            "received": 2,
            "processed_by_ai": 2,
            "persisted": 2,
            "news": [
                {
                    "id": 1,
                    "title": "Nueva política de transporte",
                    "publication_type": "article",
                    "date": "2025-01-09",
                    "support": "web",
                    "media": "Diario Nacional",
                    "section": "Politics",
                    "author": "María González",
                    "interviewee": null,
                    "link": "https://example.com/news-1",
                    "audience_size": 50000,
                    "quotation": 0.0,
                    "valuation": "neutral",
                    "political_factor": "national",
                    "plain_text": "El gobierno anunció una nueva política...",
                    "crisis": false,
                    "created_at": "2025-01-09T10:30:00Z",
                    "updated_at": "2025-01-09T10:30:00Z",
                    "topic": {
                        "id": 1,
                        "name": "Transport"
                    },
                    "mentions": [
                        {
                            "id": 1,
                            "name": "Ministerio de Transporte"
                        }
                    ],
                    "creator": {
                        "id": 1,
                        "name": "Juan Pérez"
                    },
                    "reviewer": null
                }
            ],
            "errors": []
        }    

+ Response 400 (application/json)
    + Attributes
        + error: "Missing required parameters" (string)
        + details (string) - Detalles del error

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Actualizar Noticia [PUT /api/v1/news/{id}]

Actualiza una noticia existente. Requiere autenticación y el usuario debe tener permisos para revisar noticias.

+ Parameters
    + id: 1 (number, required) - ID de la noticia

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "news": {
                "title": "Título actualizado",
                "publication_type": "article",
                "date": "2025-01-09",
                "support": "web",
                "media": "Diario Nacional",
                "section": "Politics",
                "author": "María González",
                "interviewee": null,
                "audience_size": 50000,
                "quotation": 0.0,
                "valuation": "positive",
                "political_factor": "national",
                "topic_id": 1,
                "mention_ids": [1, 2]
            }
        }

+ Response 200 (application/json)
    + Attributes (NewsItem)
    + Body
        {
            "id": 1,
            "title": "Título actualizado",
            "publication_type": "article",
            "date": "2025-01-09",
            "support": "web",
            "media": "Diario Nacional",
            "section": "Politics",
            "author": "María González",
            "interviewee": null,
            "link": "https://example.com/news-1",
            "audience_size": 50000,
            "quotation": 0.0,
            "valuation": "positive",
            "political_factor": "national",
            "plain_text": "El gobierno anunció una nueva política...",
            "crisis": false,
            "created_at": "2025-01-09T10:30:00Z",
            "updated_at": "2025-01-09T10:30:00Z",
            "topic": {
                "id": 1,
                "name": "Transport"
            },
            "mentions": [
                {
                    "id": 1,
                    "name": "Ministerio de Transporte"
                }
            ],
            "creator": {
                "id": 1,
                "name": "Juan Pérez"
            },
            "reviewer": {
                "id": 2,
                "name": "Ana García"
            }
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

## Clippings [/api/v1/clippings]

### Listar Clippings [GET]

Obtiene una lista paginada de todos los clippings en el sistema, ordenados por fecha de creación descendente. Cada clipping incluye `topic` (objeto con ID y nombre) y el flag `has_report`.

**Parámetros de filtrado disponibles:**
- `topic_id`: Filtrar por tema específico
- `start_date`: Filtrar clippings desde una fecha (formato: YYYY-MM-DD)
- `end_date`: Filtrar clippings hasta una fecha (formato: YYYY-MM-DD)
- `news_ids[]`: Filtrar clippings que contengan noticias específicas

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes
        + clippings (array[ClippingIndex])
        + pagination (Pagination)
        
    + Body
    
        {
            "clippings": [
                {
                    "id": 1,
                    "name": "Clipping Semanal Transporte",
                    "start_date": "2025-01-01",
                    "end_date": "2025-01-07",
                    "topic": {
                        "id": 1,
                        "name": "Transporte"
                    },
                    "news_ids": [1, 2, 3],
                    "has_report": true,
                    "created_at": "2025-01-09T10:30:00Z",
                    "updated_at": "2025-01-09T10:30:00Z",
                    "creator": {
                        "id": 1,
                        "name": "Juan Pérez"
                    },
                    "reviewer": null
                }
            ],
            "pagination": {
                "page": 1,
                "count": 1,
                "pages": 1,
                "prev": null,
                "next": null
            }
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

### Crear Clipping [POST]

Crea un nuevo clipping en el sistema con un conjunto de noticias y fechas específicas.

> Es obligatorio incluir al menos un ID de noticia en `news_ids`.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "clipping": {
                "name": "Clipping Semanal Transporte",
                "start_date": "2025-01-01",
                "end_date": "2025-01-07",
                "topic_id": 1,
                "news_ids": [1, 2, 3]
            }
        }

+ Response 201 (application/json)
    + Attributes (ClippingSimple)
    + Body
        {
            "id": 1,
            "name": "Clipping Semanal Transporte",
            "start_date": "2025-01-01",
            "end_date": "2025-01-07",
            "topic_id": 1,
            "news_ids": [1, 2, 3],
            "created_at": "2025-01-09T10:30:00Z",
            "updated_at": "2025-01-09T10:30:00Z",
            "creator_id": 1,
            "reviewer_id": 1            
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Obtener Clipping [GET /api/v1/clippings/{id}]

Obtiene los detalles de un clipping específico.

+ Parameters
    + id: 1 (number, required) - ID del clipping

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes (ClippingShow)

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

### Actualizar Clipping [PUT /api/v1/clippings/{id}]

Actualiza un clipping existente. **Permisos:** Solo el creador del clipping o un administrador pueden actualizarlo.

+ Parameters
    + id: 1 (number, required) - ID del clipping

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "clipping": {
                "name": "Clipping Actualizado",
                "start_date": "2025-01-01",
                "end_date": "2025-01-07",
                "topic_id": 1,
                "news_ids": [1, 2, 3, 4]
            }
        }

+ Response 200 (application/json)
    + Attributes (ClippingSimple)
    + Body
        {
            "id": 1,
            "name": "Clipping Actualizado",
            "start_date": "2025-01-01",
            "end_date": "2025-01-07",
            "topic_id": 1,
            "news_ids": [1, 2, 3, 4],
            "created_at": "2025-01-09T10:30:00Z",
            "updated_at": "2025-01-10T08:15:00Z",
            "creator_id": 1,
            "reviewer_id": 1
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 403 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Eliminar Clipping [DELETE /api/v1/clippings/{id}]

Elimina permanentemente un clipping del sistema. **Permisos:** Solo el creador del clipping o un administrador pueden eliminarlo.

+ Parameters
    + id: 1 (number, required) - ID del clipping

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 204

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 403 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

## Reportes de Clippings [/api/v1/clippings/{id}/report]

### Generar Reporte de Clipping [POST]

Genera un reporte de clipping utilizando IA generativa basado en las métricas y noticias del clipping. El reporte se genera automáticamente y se almacena en el sistema.

**Permisos:** Solo el creador del clipping o un administrador pueden generar reportes.

+ Parameters
    + id: 1 (number, required) - ID del clipping

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes (ClippingReport)
    + Body
        {
            "clipping_report": {
                "id": 1,
                "clipping_id": 1,
                "content": "# Resumen del Clipping Semanal\n\n## Análisis General\n\nDurante el período del 1 al 7 de enero de 2025, se registraron 3 noticias relacionadas con el tema de Transporte...",
                "metadata": {
                    "fecha_generacion": "2025-01-09T10:30:00Z",
                    "tiempo_generacion": "5s",
                    "total_tokens": 1234,
                    "modelo_ia": "gpt-4",
                    "version": "1.0"
                },
                "manually_edited": false,
                "created_at": "2025-01-09T10:30:00Z",
                "updated_at": "2025-01-09T10:30:00Z",
                "creator": {
                    "id": 1,
                    "name": "Juan Perez"
                },
                "reviewer": null
            }
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 403 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])
    + Body
        {
            "errors": [
                "External AI service is unreachable"
            ]
        }

### Obtener Reporte de Clipping [GET]

Obtiene el reporte generado para un clipping específico. Si no existe un reporte, retorna 404.

+ Parameters
    + id: 1 (number, required) - ID del clipping

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes (ClippingReport)
    + Body
        {
            "clipping_report": {
                "id": 1,
                "clipping_id": 1,
                "content": "# Resumen del Clipping Semanal\n\n## Análisis General\n\nDurante el período del 1 al 7 de enero de 2025, se registraron 3 noticias relacionadas con el tema de Transporte...",
                "metadata": {
                    "fecha_generacion": "2025-01-09T10:30:00Z",
                    "tiempo_generacion": "5s",
                    "total_tokens": 1234,
                    "modelo_ia": "gpt-4",
                    "version": "1.0"
                },
                "manually_edited": false,
                "created_at": "2025-01-09T10:30:00Z",
                "updated_at": "2025-01-09T10:30:00Z",
                "creator": {
                    "id": 1,
                    "name": "Juan Perez"
                },
                "reviewer": null
            }
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

### Actualizar Reporte de Clipping [PATCH]

Actualiza el contenido y metadatos de un reporte de clipping existente. Permite modificar el contenido del reporte y sus metadatos asociados.

**Permisos:** Solo el creador del clipping o un administrador pueden actualizar reportes.

+ Parameters
    + id: 1 (number, required) - ID del clipping

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "clipping_report": {
                "content": "# Resumen Actualizado del Clipping\n\n## Análisis General Actualizado\n\nDurante el período del 1 al 7 de enero de 2025, se registraron 3 noticias relacionadas con el tema de Transporte...",
                "metadata": {
                    "fecha_actualizacion": "2025-01-09T11:00:00Z",
                    "version": "2.0",
                    "modelo_ia": "gpt-4",
                    "tiempo_generacion": "5s",
                    "total_tokens": 1234
                }
            }
        }

+ Response 200 (application/json)
    + Attributes (ClippingReport)
    + Body
        {
            "clipping_report": {
                "id": 1,
                "clipping_id": 1,
                "content": "# Resumen Actualizado del Clipping\n\n## Análisis General Actualizado\n\nDurante el período del 1 al 7 de enero de 2025, se registraron 3 noticias relacionadas con el tema de Transporte...",
                "metadata": {
                    "fecha_actualizacion": "2025-01-09T11:00:00Z",
                    "version": "2.0",
                    "modelo_ia": "gpt-4",
                    "tiempo_generacion": "5s",
                    "total_tokens": 1234
                },
                "manually_edited": true,
                "created_at": "2025-01-09T10:30:00Z",
                "updated_at": "2025-01-09T11:00:00Z",
                "creator": {
                    "id": 1,
                    "name": "Juan Perez"
                },
                "reviewer": {
                    "id": 2,
                    "name": "Maria Garcia"
                }
            }
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 403 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])
    + Body
        {
            "errors": [
                {
                    "content": [
                        "can't be blank"
                    ]
                }
            ]
        }

## Topics [/api/v1/topics]

### Listar Temas [GET]

Obtiene una lista de todos los temas disponibles en el sistema.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes
        + topics (array[Topic])
        
    + Body
        {
            "topics": [
                {
                    "id": 1,
                    "name": "Transport",
                    "description": "Noticias relacionadas con transporte",
                    "enabled": true,
                    "crisis": false,
                    "created_at": "2025-01-09T10:30:00Z",
                    "updated_at": "2025-01-09T10:30:00Z"
                }
            ]
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

### Crear Tema [POST]

Crea un nuevo tema en el sistema.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "topic": {
                "name": "Nuevo Tema",
                "description": "Descripción del tema",
                "enabled": true
            }
        }

+ Response 201 (application/json)
    + Attributes (Topic)
    + Body
        {
            "id": 2,
            "name": "Nuevo Tema",
            "description": "Descripción del tema",
            "enabled": true,
            "crisis": false,
            "created_at": "2025-01-09T10:30:00Z",
            "updated_at": "2025-01-09T10:30:00Z"
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Actualizar Tema [PUT /api/v1/topics/{id}]

Actualiza un tema existente.

+ Parameters
    + id: 1 (number, required) - ID del tema

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "topic": {
                "name": "Tema Actualizado",
                "description": "Nueva descripción",
                "enabled": false
            }
        }

+ Response 200 (application/json)
    + Attributes (Topic)

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Eliminar Tema [DELETE /api/v1/topics/{id}]

Elimina un tema del sistema.

+ Parameters
    + id: 1 (number, required) - ID del tema

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 204

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

## Mentions [/api/v1/mentions]

### Listar Menciones [GET]

Obtiene una lista de todas las menciones disponibles en el sistema.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes
        + mentions (array[Mention])
        
    + Body
        {
            "mentions": [
                {
                    "id": 1,
                    "name": "Ministerio de Transporte",
                    "enabled": true,
                    "created_at": "2025-01-09T10:30:00Z",
                    "updated_at": "2025-01-09T10:30:00Z"
                }
            ]
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

### Crear Mención [POST]

Crea una nueva mención en el sistema.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "mention": {
                "name": "Nueva Mención",
                "enabled": true
            }
        }

+ Response 201 (application/json)
    + Attributes (Mention)
    + Body
        {
            "id": 2,
            "name": "Nueva Mención",
            "enabled": true,
            "created_at": "2025-01-09T10:30:00Z",
            "updated_at": "2025-01-09T10:30:00Z"
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Actualizar Mención [PUT /api/v1/mentions/{id}]

Actualiza una mención existente.

+ Parameters
    + id: 1 (number, required) - ID de la mención

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "mention": {
                "name": "Mención Actualizada",
                "enabled": false
            }
        }

+ Response 200 (application/json)
    + Attributes (Mention)

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Eliminar Mención [DELETE /api/v1/mentions/{id}]

Elimina una mención del sistema.

+ Parameters
    + id: 1 (number, required) - ID de la mención

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 204

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

## Administración de Usuarios [/api/v1/users]

### Listar Usuarios [GET]

Obtiene una lista de todos los usuarios del sistema. Requiere permisos de administrador.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes
        + users (array[User])
        
    + Body
        {
            "users": [
                {
                    "id": 1,
                    "email": "admin@example.com",
                    "name": "Administrador",
                    "username": "admin",
                    "first_name": "Admin",
                    "last_name": "User",
                    "role": "admin",
                    "created_at": "2025-01-09T10:30:00Z",
                    "updated_at": "2025-01-09T10:30:00Z"
                }
            ]
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 403 (application/json)
    + Attributes
        + errors (array[Error])

### Obtener Usuario por ID [GET /api/v1/users/{id}]

Obtiene la información de un usuario específico.

+ Parameters
    + id: 1 (number, required) - ID del usuario

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes (User)

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

### Actualizar Usuario por ID [PUT /api/v1/users/{id}]

Actualiza la información de un usuario específico.

+ Parameters
    + id: 1 (number, required) - ID del usuario

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "user": {
                "username": "nuevo_username",
                "first_name": "Nuevo",
                "last_name": "Nombre",
                "email": "nuevo@example.com",
                "role": "user"
            }
        }

+ Response 200 (application/json)
    + Attributes (User)

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Eliminar Usuario [DELETE /api/v1/users/{id}]

Elimina un usuario del sistema.

+ Parameters
    + id: 1 (number, required) - ID del usuario

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 204

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

### Cambiar Contraseña de Usuario [PATCH /api/v1/users/{id}/change_password]

Cambia la contraseña de un usuario específico.

+ Parameters
    + id: 1 (number, required) - ID del usuario

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "user": {
                "password": "nueva_contraseña",
                "password_confirmation": "nueva_contraseña"
            }
        }

+ Response 200 (application/json)
    + Attributes (User)

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

### Cambiar Contraseña de Usuario Actual [PATCH /api/v1/user/change_password]

Cambia la contraseña del usuario autenticado actual.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "user": {
                "password": "nueva_contraseña",
                "password_confirmation": "nueva_contraseña"
            }
        }

+ Response 200 (application/json)
    + Attributes (User)

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])

## Configuraciones de IA [/api/v1/ai_configurations]

### Listar Configuraciones de IA [GET]

Obtiene una lista de todas las configuraciones de IA habilitadas en el sistema.

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}

+ Response 200 (application/json)
    + Attributes
        + ai_configurations (array[AiConfiguration])
        
    + Body
        {
            "ai_configurations": [
                {
                    "key": "default_topic",
                    "value": "1",
                    "value_type": "reference",
                    "display_name": "Tema por defecto",
                    "description": "Tema que se asigna por defecto a las noticias procesadas",
                    "enabled": true,
                    "reference_type": "Topic",
                    "created_at": "2025-01-09T10:30:00Z",
                    "updated_at": "2025-01-09T10:30:00Z"
                }
            ]
        }

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

### Actualizar Configuración de IA [PUT /api/v1/ai_configurations/{key}]

Actualiza una configuración de IA específica.

+ Parameters
    + key: "openai_api_key" (string, required) - Clave de la configuración

+ Request (application/json)
    + Headers
        Authorization: Bearer {jwt_token}
    + Body
        {
            "ai_configuration": {
                "value": "nuevo_valor",
                "enabled": true
            }
        }

+ Response 200 (application/json)
    + Attributes (AiConfiguration)

+ Response 401 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 404 (application/json)
    + Attributes
        + errors (array[Error])

+ Response 422 (application/json)
    + Attributes
        + errors (array[Error])
---

## Group IA

Módulo de IA. Para interactuar con esta API se requiere un Api Key.

## Clasificación de noticias [/v1/procesar-noticias]

### Enviar lote de noticias para clasificar [POST]

Procesa un conjunto de hasta 10 URLs de noticias. Devuelve la información estructurada de cada noticia.

+ Request (application/json)

    + Headers

            Authorization: Bearer {token}

    + Body

            {
              "urls": [
                "https://ejemplo.com/noticia-1",
                "https://ejemplo.com/noticia-2"
              ],
              "temas": [],
              "menciones": [],
              "ministerios_key_words": ["Ministerio de Cultura", "Ministerio de Cultura de Buenos Aires"],
              "ministro_key_words": ["Pepe Pompin", "Ministro", "Ministro de cultura"],
            }

+ Response 200 (application/json)

    + Attributes
        + recibidas: 2 (number) - Cantidad de URLs recibidas.
        + procesadas: 2 (number) - Cantidad de URLs procesadas exitosamente.
        + noticias (array[Noticia])
        + errors (array[ErrorNoticia])

    + Body

            {
              "recibidas": 2,
              "procesadas": 2,
              "data": [
                {
                  "TITULO": "Texto del título detectado",
                  "TIPO PUBLICACION": "nota",
                  "FECHA": "2025-07-09",
                  "SOPORTE": "web",
                  "MEDIO": "Diario Ejemplo",
                  "SECCION": "Política",
                  "AUTOR": "Nombre Apellido",
                  "ENTREVISTADO": "",
                  "TEMA": "Transporte",
                  "LINK": "https://ejemplo.com/noticia-5",
                  "ALCANCE": "12.000",
                  "COTIZACION": "$35000.0",
                  "VALORACION": "neutro",
                  "FACTOR POLITICO": "medio",
                  "MENCIONES": []
                }
              ],
              "errores": [{"url": "1", "motivo": "error 1"},{"url": "2", "motivo": "error 2"}],
              "tiempo_procesamiento": ""
            }


+ Response 422 (application/json)

    + Attributes
        + recibidas: 2 (number) - Cantidad de URLs recibidas.
        + procesadas: 2 (number) - Cantidad de URLs procesadas exitosamente.
        + noticias (array[Noticia])
        + errors (array[ErrorNoticia])

    + Body

            {
                "data": [],
                "errores": [
                    {
                        "url": "1",
                        "motivo": "error 1"
                    },
                    {
                        "url": "2",
                        "motivo": "error 2"
                    }
                ]
            }
            

+ Response 400 (application/json)

    + Attributes
        + mensaje: (string). Mensaje de error

    + Body

            {
              "mensaje": "urls must contain between 1 and 10 unique items.",
            }

## Reportes de clippings [/v1/generar-informe-clipping]

### Generar reporte de clipping [POST]

Recibe un conjunto de noticias **ya clasificadas** por el backend y genera un informe de clipping con IA generativa.

+ Request (application/json)

    + Headers

            Authorization: Bearer {internal-token}

    + Body

            {
              "noticias": [
                {
                  "titulo": "Texto del título detectado",
                  "tipo_publicacion": "nota",
                  "fecha": "2025-07-09",
                  "soporte": "web",
                  "medio": "Diario Ejemplo",
                  "seccion": "Política",
                  "autor": "Nombre Apellido",
                  "entrevistado": null,
                  "tema": "Transporte",
                  "link": "https://ejemplo.com/noticia-1",
                  "alcance": 120000,
                  "cotizacion": 0.0,
                  "valoracion": "neutro",
                  "factor_politico": "medio",
                  "gestion": "GCBA",
                  "texto_plano": "Cuerpo completo extraído y limpiado...",
                  "crisis": "no",
                  "menciones": []
                }
              ],
              "configuracion": {
                "titulo": "Clipping semanal",
                "formato": "markdown"
              }
            }

+ Response 200 (application/json)

    + Attributes (ClippingReport)

    + Body

            {
              "titulo": "Clipping semanal",
              "formato": "markdown",
              "contenido": "# Resumen del clipping\n\n## Noticias destacadas\n- Texto del título detectado...",
              "resumen": [
                "Cobertura de Transporte en medios nacionales.",
                "Predomina valoración neutra."
              ]
            }


## Data Structures

### NewsItem (object)
+ id: 1 (number) - ID único de la noticia
+ title: "Título de la noticia" (string) - Título de la noticia
+ publication_type: "article" (string) - Tipo de publicación (article, interview, editorial, opinion, o "REVISAR MANUAL")
+ date: "2025-01-09" (string) - Fecha de la noticia (ISO 8601)
+ support: "web" (string) - Soporte de la noticia
+ media: "Nombre del Medio" (string) - Nombre del medio de comunicación
+ section: "Politics" (string) - Sección de la noticia
+ author: "Nombre del Autor" (string) - Autor de la noticia
+ interviewee: "Nombre del Entrevistado" (string, nullable) - Persona entrevistada
+ link: "https://example.com/news" (string) - URL de la noticia original
+ audience_size: 10000 (number, nullable) - Tamaño de la audiencia
+ quotation: 0.0 (number, nullable) - Cotización monetaria
+ valuation: "neutral" (string, nullable) - Valoración (positive, neutral, negative, o "REVISAR MANUAL")
+ political_factor: "medio" (string, nullable) - Factor político (local, regional, national, international, o "REVISAR MANUAL")
+ plain_text: "Texto plano de la noticia..." (string, nullable) - Contenido de texto plano
+ crisis: false (boolean) - Indica si la noticia está relacionada con una crisis
+ created_at: "2025-01-09T10:30:00Z" (string) - Fecha de creación (ISO 8601)
+ updated_at: "2025-01-09T10:30:00Z" (string) - Fecha de última actualización (ISO 8601)
+ topic (EntityRef, nullable) - Tema asociado a la noticia
+ mentions (array[EntityRef]) - Menciones asociadas a la noticia
+ creator (EntityRef, nullable) - Usuario que procesó/creó la noticia
+ reviewer (EntityRef, nullable) - Usuario que revisó la noticia

### EntityRef (object)
+ id: 1 (number) - Id único del registro
+ name: "Name" (string) - Nombre del registro

### Topic (object)
+ id: 1 (number) - ID único del tema
+ name: "Transport" (string) - Nombre del tema
+ description: "Noticias relacionadas con transporte" (string, nullable) - Descripción del tema
+ enabled: true (boolean) - Indica si el tema está habilitado
+ crisis: false (boolean) - Indica si el tema está relacionado con crisis
+ created_at: "2025-01-09T10:30:00Z" (string) - Fecha de creación (ISO 8601)
+ updated_at: "2025-01-09T10:30:00Z" (string) - Fecha de última actualización (ISO 8601)

### Mention (object)
+ id: 1 (number) - ID único de la mención
+ name: "Mention1" (string) - Nombre de la mención
+ enabled: true (boolean) - Indica si la mención está habilitada
+ created_at: "2025-01-09T10:30:00Z" (string) - Fecha de creación (ISO 8601)
+ updated_at: "2025-01-09T10:30:00Z" (string) - Fecha de última actualización (ISO 8601)

### User (object)
+ id: 1 (number) - ID único del usuario
+ email: "juan.perez@example.com" (string) - Email del usuario
+ name: "Juan Pérez" (string) - Nombre completo del usuario
+ username: "juan.perez" (string) - Nombre de usuario
+ first_name: "Juan" (string) - Nombre del usuario
+ last_name: "Pérez" (string) - Apellido del usuario
+ role: "user" (string) - Rol del usuario (user, admin)
+ created_at: "2025-01-09T10:30:00Z" (string) - Fecha de creación (ISO 8601)
+ updated_at: "2025-01-09T10:30:00Z" (string) - Fecha de última actualización (ISO 8601)

### AiConfiguration (object)
+ key: "default_topic" (string) - Clave única de la configuración
+ value: "1" (string) - Valor de la configuración
+ value_type: "reference" (string) - Tipo de valor (string, array, reference)
+ display_name: "Tema por defecto" (string) - Nombre para mostrar
+ description: "Tema que se asigna por defecto a las noticias procesadas" (string) - Descripción de la configuración
+ enabled: true (boolean) - Indica si la configuración está habilitada
+ reference_type: "Topic" (string) - Tipo de referencia
+ created_at: "2025-01-09T10:30:00Z" (string) - Fecha de creación (ISO 8601)
+ updated_at: "2025-01-09T10:30:00Z" (string) - Fecha de última actualización (ISO 8601)

### ClippingBase (object)
+ id: 1 (number) - ID único del clipping
+ name: "Clipping Semanal Transporte" (string) - Nombre del clipping
+ start_date: "2025-01-01" (string) - Fecha de inicio del período (ISO 8601)
+ end_date: "2025-01-07" (string) - Fecha de fin del período (ISO 8601)
+ topic (EntityRef) - Tema asociado al clipping (incluye id y nombre)
+ has_report: true (boolean) - Indica si el clipping tiene un reporte generado
+ created_at: "2025-01-09T10:30:00Z" (string) - Fecha de creación (ISO 8601)
+ updated_at: "2025-01-09T10:30:00Z" (string) - Fecha de última actualización (ISO 8601)
+ creator (EntityRef) - Usuario que creó el clipping
+ reviewer (EntityRef, nullable) - Usuario que revisó el clipping por última vez

### ClippingIndex (ClippingBase)
+ news_ids: [1, 2, 3] (array[number]) - IDs de las noticias incluidas en el clipping. Disponible en listados para filtrar o consultar rápidamente.

### ClippingShow (ClippingBase)
+ news (array[NewsItem]) - Noticias completas asociadas al clipping. Incluido en el endpoint de detalle.
+ metrics (ClippingMetrics, optional) - Métricas agregadas del clipping. Disponible en el endpoint de detalle.

### ClippingSimple (object)
+ id: 1 (number) - ID único del clipping recién procesado
+ name: "Clipping Semanal Transporte" (string) - Nombre del clipping
+ start_date: "2025-01-01" (string) - Fecha de inicio del período (ISO 8601)
+ end_date: "2025-01-07" (string) - Fecha de fin del período (ISO 8601)
+ topic_id: 1 (number) - ID del tema asociado
+ news_ids: [1, 2, 3] (array[number]) - IDs de las noticias vinculadas
+ created_at: "2025-01-09T10:30:00Z" (string) - Fecha de creación (ISO 8601)
+ updated_at: "2025-01-09T10:30:00Z" (string) - Fecha de última actualización (ISO 8601)
+ creator_id: 1 (number) - ID único del creador
+ reviewer_id: 1 (number) - ID único del último editor

### ClippingMetrics (object)
+ generated_at: "2025-01-09T10:30:00Z" (string) - Momento del último cálculo (ISO 8601)
+ date_range (object) - Rango temporal de las noticias incluidas
    + from: "2025-01-01" (string, nullable) - Fecha mínima encontrada
    + to: "2025-01-07" (string, nullable) - Fecha máxima encontrada
+ news_count: 3 (number) - Cantidad total de noticias consideradas
+ valuation (object) - Distribución de noticias por valoración
    + positive (MetricBreakdown)
    + neutral (MetricBreakdown)
    + negative (MetricBreakdown)
    + total: 3 (number) - Total de noticias con valoración conocida
+ media_stats (MetricCollection) - Estadísticas agrupadas por medio
+ support_stats (MetricCollection) - Estadísticas agrupadas por soporte
+ mention_stats (MentionStatsCollection) - Estadísticas de menciones asociadas a las noticias del clipping
+ audience (MetricAggregate, nullable) - Agregados de audiencia cuando existen datos
+ quotation (MetricAggregate, nullable) - Agregados de cotización cuando existen datos
+ crisis: false (boolean) - Indica si el tema asociado está marcado como crisis

### MetricBreakdown (object)
+ count: 1 (number) - Cantidad de noticias en la categoría
+ percentage: 33.33 (number) - Porcentaje respecto del total

### MetricCollection (object)
+ total: 3 (number) - Total de elementos considerados
+ items: (array[MetricCollectionItem]) - Detalle por clave

### MetricCollectionItem (object)
+ key: "Clarín" (string) - Valor agrupado
+ count: 2 (number) - Cantidad de noticias con ese valor
+ percentage: 66.67 (number) - Porcentaje respecto del total del agrupamiento

### MentionStatsCollection (object)
+ total: 4 (number) - Total de menciones contabilizadas en las noticias del clipping
+ items: (array[MentionStatsItem]) - Detalle por mención

### MentionStatsItem (object)
+ mention_id: 1 (number) - ID único de la mención
+ name: "Ministerio de Transporte" (string) - Nombre de la mención
+ count: 2 (number) - Cantidad de veces que aparece la mención en las noticias del clipping
+ percentage: 50.0 (number) - Porcentaje respecto del total de menciones

### MetricAggregate (object)
+ total: 3000 (number) - Suma total del campo
+ average: 1500.0 (number) - Promedio del campo
+ max: (MetricAggregateMax, nullable) - Valor máximo encontrado

### MetricAggregateMax (object)
+ news_id: 2 (number) - ID de la noticia que posee el máximo
+ value: 2000 (number) - Valor máximo registrado

### Pagination (object)
+ page: 1 (number) - Página actual
+ count: 25 (number) - Total de elementos
+ pages: 3 (number) - Total de páginas
+ prev: null (number, nullable) - Número de página anterior
+ next: 2 (number, nullable) - Número de página siguiente

### Error (object)
+ message: "Error message" (string) - Mensaje de error

### ProcessingError (object)
+ url: "https://example.com/news" (string) - URL que causó el error
+ reason: "Failed to save news: Validation failed" (string) - Razón del error

### Noticia (object)
- titulo: Texto del título detectado (string)
- tipo_publicacion: Tipo de publicación, por ejemplo "nota" (string)
- fecha: Fecha en formato ISO-8601 (string) - e.g. `2025-07-09`
- soporte: Soporte, por ejemplo "web" (string)
- medio: Medio de publicación (string)
- seccion: Sección del medio (string, optional)
- autor: Autor/a (string, optional)
- entrevistado: Entrevistado/a (string, optional)
- tema: Tema o categoría (string, optional)
- link: URL de la noticia (string)
- alcance: Alcance estimado (number, optional)
- cotizacion: Cotización asociada (number, optional)
- valoracion: Sentimiento: `positivo` | `negativo` | `neutro` (string)
- factor_politico: Intensidad del factor político (string, optional)
- gestion: Jurisdicción o gestión referida (string, optional)
- texto_plano: Texto completo extraído (string, optional)
- crisis: Indicador de crisis (string, optional)
- menciones: Menciones de la noticia (array[string], optional)
- usuario_creador: Alias usuario creador (string, optional)
- usuario_revisor: Alias usuario revisor (string, optional)

### ErrorNoticia (object)
- url: URL que falló (string)
- detail: Descripción del error (string)

### ClippingReport (object)
+ id: 1 (number) - ID único del reporte
+ clipping_id: 1 (number) - ID del clipping asociado
+ content: "# Resumen del Clipping Semanal..." (string) - Contenido del reporte generado por IA
+ metadata (object) - Metadatos del reporte
    + fecha_generacion: "2025-01-09T10:30:00Z" (string) - Fecha de generación del reporte (ISO 8601)
    + tiempo_generacion: "5s" (string) - Tiempo que tardó en generarse el reporte
    + total_tokens: 1234 (number) - Número total de tokens utilizados
+ created_at: "2025-01-09T10:30:00Z" (string) - Fecha de creación (ISO 8601)
+ updated_at: "2025-01-09T10:30:00Z" (string) - Fecha de última actualización (ISO 8601)
